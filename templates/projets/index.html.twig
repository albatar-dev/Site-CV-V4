{% extends 'base.html.twig' %}

{% block title %}
	Jocelyn ARZUR |
	{{ projet.titreProjet }}
{% endblock %}

{% block body %}
<div class="container">

	{% if (projet.natureProjet == 'projets_afpa') %}
		<h2 class="text-muted mx-3">{{ projet.titreProjet }}</h2>
		<p>{{ projet.description }}</p>


		<div id="carouselProjet" class="carousel slide bg-dark mr-3 mb-3" data-ride="carousel">
			<ol class="carousel-indicators">
				{% set i = 0 %}
				{% for infosVersion in projet.projetsAfpas %}
					{% if i == 0 %}
						<li data-target="#carouselProjet" data-slide-to="0" class="active"></li>
					{% else %}
						<li data-target="#carouselProjet" data-slide-to="<?= $i ?>"></li>
					{% endif %}
					{% set i = i+1 %}
				{% endfor %}

			</ol>
			<div class="carousel-inner">
				{% set i = 0 %}
				{% for infosVersion in projet.projetsAfpas %}
					{% if (i == 0) %}
						<div class="carousel-item active justify-content-center">
						{% else %}
							<div class="carousel-item justify-content-center">
							{% endif %}
							<img src="{{ asset('build/images/' ~ infosVersion.screen ) }}" class="d-block my-3 col-6 offset-3 img-carousel" alt="image d'accueil LaFleur {{ infosVersion.version }}">
							<div class="carousel-caption d-none d-md-block">
								<h5>{{infosVersion.version}}</h5>
							</div>
						</div>
						{% set i = i+1 %}
					{% endfor %}

				</div>
				<a class="carousel-control-prev" href="#carouselProjet" role="button" data-slide="prev">
					<span class="carousel-control-prev-icon" aria-hidden="true"></span>
					<span class="sr-only">Previous</span>
				</a>
				<a class="carousel-control-next" href="#carouselProjet" role="button" data-slide="next">
					<span class="carousel-control-next-icon" aria-hidden="true"></span>
					<span class="sr-only">Next</span>
				</a>
			</div>
			{% for infosVersion in projet.projetsAfpas %}
				<div class="row collapser" data-toggle="collapse" href="#collapse-{{infosVersion.id}}{{ infosVersion.dateCreation | date('YdMHm') }}">
					<div>
						<div class="row mx-3">
							<img class="up ml-3" src="{{ asset('build/images/arrow-down.svg') }}" alt="">
							<h2 class="text-muted mx-3">{{ infosVersion.version }}</h2>
							<img class="up" src="{{ asset('build/images/arrow-down.svg') }}" alt="">
						</div>
					</div>
				</div>
				<article class="row card collapse mx-1" id="collapse-{{infosVersion.id}}{{ infosVersion.dateCreation | date('YdMHm') }}">
					<div class="card-body media">
						<figure>
							<img src="<?= PATH ?>img\<?= $infosVersion->screen_projet ?>" alt="" class="mr-3">
						</figure>
						<div class="media-body">
							<h5>Date de création :</h5>
							{{ infosVersion.dateCreation | date('m/Y')}}
							<hr>
							<h5>Cahier des charges</h5>
							{{ infosVersion.cahierCharges }}
							<hr>
							<h5>Solutions apportées :</h5>
							{{ infosVersion.solutions }}
						</div>
					</div>
					<div class="card-footer">
						{% if infosVersion.github != null %}
							<a href="{{ infosVersion.github }}" target="_blank" class="btn btn-outline-secondary my-1">Code</a>
						{% endif %}

						{% if infosVersion.projetLink != null %}
							<a href="{{ infosVersion.projetLink }}" target="_blank" class="btn btn-outline-secondary my-1">Voir le projet</a>
						{% endif %}

						{% if infosVersion.bddLink != null %}
							<a href="{{ infosVersion.bddLink }}" target="_blank" class="btn btn-outline-secondary my-1">Base de données</a>
						{% endif %}

						{% if infosVersion.cahierChargesLink != null %}
							<a href="{{ infosVersion.cahierChargesLink }}" target="_blank" class="btn btn-outline-secondary my-1">Cahier des chages</a>
						{% endif %}
					</div>
				</article>

				<hr>
			{% endfor %}
		</div>

	{% else %}

		<h2 class="text-muted mx-3"><?= $projet->titre_projet ?></h2>
		<p><?= nl2br($projet->description_projet) ?></p>


		<div id="carouselProjet" class="carousel slide bg-dark mr-3 mb-3" data-ride="carousel">
			<ol class="carousel-indicators">
				<?php
            $i = 0;
            foreach ($infosProjet as $infosVersion) :
                $screens = $donnees->getScreensByJeux($infosVersion->version_jeux);
                foreach ($screens as $screen) :
                    if ($i == 0) { ?>
					<li data-target="#carouselProjet" data-slide-to="0" class="active"></li>
				<?php } else { ?>
					<li data-target="#carouselProjet" data-slide-to="<?= $i ?>"></li>
				<?php }
                    $i++;
                endforeach;
            endforeach; ?>
			</ol>
			<div class="carousel-inner">
			<?php
            $i = 0;
            foreach ($infosProjet as $infosVersion) :
                $screens = $donnees->getScreensByJeux($infosVersion->version_jeux);
                foreach ($screens as $screen) :
                    if ($i == 0) {
                        echo '<div class="carousel-item active">';
                    } else {
                        echo '<div class="carousel-item">';
                    }

            ?>

				<img src="<?= PATH ?>img/<?= $screen->screen_jeux ?>" class="d-block my-3 col-6 offset-3" alt="image d'accueil LaFleur <?= $infosVersion->version_jeux ?>">
				<div class="carousel-caption d-none d-md-block">
					<h5><?= $infosVersion->version_jeux ?></h5>
				</div>
			</div>
			<?php
                    $i++;
                endforeach;
            endforeach;
?>


		</div>
		<a class="carousel-control-prev" href="#carouselProjet" role="button" data-slide="prev">
			<span class="carousel-control-prev-icon" aria-hidden="true"></span>
			<span class="sr-only">Previous</span>
		</a>
		<a class="carousel-control-next" href="#carouselProjet" role="button" data-slide="next">
			<span class="carousel-control-next-icon" aria-hidden="true"></span>
			<span class="sr-only">Next</span>
		</a>
	</div>

	<?php
        foreach ($infosProjet as $infosVersion) :
    ?>


	<div class="row collapser" data-toggle="collapse" href="#collapse-V1">
		<div>
			<div class="row mx-3">
				<img class="up ml-3" src="<?= PATH ?>.yarn\cache\@primer-octicons-npm-9.5.0-fd988a671f-2\node_modules\@primer\octicons\build\svg\arrow-down.svg" alt="">
				<h2 class="text-muted mx-3"><?= $infosVersion->version_jeux ?></h2>
				<img class="up" src="<?= PATH ?>.yarn\cache\@primer-octicons-npm-9.5.0-fd988a671f-2\node_modules\@primer\octicons\build\svg\arrow-down.svg" alt="">
			</div>
		</div>
	</div>
	<article class="row card collapse mx-1" id="collapse-V1">
		<div class="card-body media">
			<figure>
				<img src="<?= PATH ?>img\snakeScreen-ig-z1-mt0.png" alt="" class="mr-3">
			</figure>
			<div class="media-body">
				<h5>Date de création :</h5>
				<?= $infosVersion->annee . '-' . $infosVersion->mois ?>
				<hr>
				<h5>Idée :</h5>
				<?= nl2br($infosVersion->idee_jeux) ?>
				<hr>
				<h5>Solutions trouvées :</h5>
				<?= nl2br($infosVersion->solution_jeux) ?>
				<hr>
				<h5>Règles :</h5>
				<?= $infosVersion->regles_jeux ?>
				<hr>
				<h5>Commandes :</h5>
				<img src="<?= PATH ?>img/<?= $infosVersion->commandes_jeux ?>" alt="">
			</div>
		</div>
		<div class="card-footer">
			<?php if (!empty($infosVersion->github_link)) : ?>
			<a href="<?= $infosVersion->github_link ?>" target="_blank" class="btn btn-outline-secondary my-1">Code</a>
			<?php endif;
                if (!empty($infosVersion->projet_link)) : ?>
			<a href="<?= PATH . 'projets/' . $infosVersion->projet_link ?>" target="_blank" class="btn btn-outline-secondary my-1">Voir le projet</a>
			<?php endif;
                if (!empty($infosVersion->bdd_link)) : ?>
			<a href="<?= PATH . $infosVersion->gitbdd_link ?>" target="_blank" class="btn btn-outline-secondary my-1">Base de données</a>
			<?php endif;
                if (!empty($infosVersion->cahier_charges_link)) : ?>
			<a href="<?= PATH . $infosVersion->cahier_charges_link ?>" target="_blank" class="btn btn-outline-secondary my-1">Cahier des chages</a>
			<?php endif; ?>
		</div>
	</article>

	<hr>
	<?php
        endforeach;
    } ?></div>{% endif %}{% endblock %}
